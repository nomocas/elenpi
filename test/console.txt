




// var text = '<div id="hello" class=reu >foo <br> <!-- hello \n--> <span class="blu" > bar </span></div><home /> hello ';
var text = '<div id="hello" class=reu >foo <br> <!-- hello \n--> <span class="blu" > bar </span></div><home /> hello <script type="text/javascript">var a = 12, \nb = a < 14;</script>';

function perf() {
    /*var text2 = text;
        for (var j = 0; j < 1000; ++j)
            text2 += '\n' + text;*/


    //var text = '<div id="hello" class="reu" ></div>';
    console.time("html parser")
    for (var i = 0; i < 1000; ++i)
        var res = parser.parse(text);
    console.timeEnd("html parser")
    console.log('res : ', JSON.stringify(res, null, ' '));
}
// perf();




/*
var descriptor = {};

console.time("lexer");
for (var i = 0; i < 1000; ++i)
    var res = Elenpi.exec(text, 'document', descriptor);
//var res =  Elenpi.exec('<!-- comment --><div id="hello" class="reu">foo <span class="blu"> bar</span></div> <home /> hello', Elenpi.rules.children, descriptor); 

//var res = Elenpi.exec('<!-- hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello -->', Elenpi.rules.comment, descriptor);
//var res = Elenpi.exec('<div>first</div><!-- hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello -->\n<div>hello</div>', Elenpi.rules.children, descriptor);

//    var res = calls.exec("    click ( '12', 14, true, blur(2, 4, hello( false).roo())). flup(12345)", descriptor);
//var res =  Elenpi.exec("flup(12345)", 'calls', descriptor);              
//Elenpi.exec("click(true, hello(14), bye, 12)", 'call');


console.timeEnd("lexer");


//Elenpi.exec("    click()", 'call');
console.log('|' + res + '|', JSON.stringify(descriptor.calls, null, ' '));
*/
//Elenpi.exec("click(true, hello(14), bye, 12)", 'call');



/*
    try {
        var r = exec("click()", Elenpi.rules.directives);
        // var r = exec("click(addUser).setClass('your-class', 'active')", Elenpi.rules.directives);
        console.log('lexer result : ', r);
    } catch (e) {
        console.log('error : ', e, e.stack);
    }
    */
/*
    var tag = l().regExp('<').id('tagName').space().zeroOrMore('attributes', attr().sp()).oneOf(chars('>').text().tagClose(), '/>');

    var attr = sp().id('attrName').zeroOrOne(l().regExp('=').oneOf(char('"').allBut('"').chars('"'), l().allBut(sp())));
    var text = allBut('<');

    var tagClose = regExp('</').id('tagName').sp().zeroOrMore('attributes', attr().space()).oneOf('>', '/>');
*/