var descriptor = {};

var fs = require("fs");
var text = fs.readFileSync('./test.html').toString('utf8');
var max = 10;
console.time("lexer (" + max + ")");

for (var i = 0; i < max; ++i)

    var res = Elenpi.exec(text, Elenpi.rules.document, descriptor);


//var res = Elenpi.exec('<!-- hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello -->', Elenpi.rules.comment, descriptor);
//var res = Elenpi.exec('<DIV>first</DIV><div>hello</div>', Elenpi.rules.children, descriptor);

// var res =  calls.exec("    click ( '12', 14, true, blur(2, 4, hello( false).roo())). flup(12345)", descriptor);              
//var res =  Elenpi.exec("flup(12345)", 'calls', descriptor);              
//Elenpi.exec("click(true, hello(14), bye, 12)", 'call');


console.timeEnd("lexer (" + max + ")");


/*
var descriptor = {};

console.time("lexer");
for (var i = 0; i < 1000; ++i)
    var res = Elenpi.exec(text, 'document', descriptor);
//var res =  Elenpi.exec('<!-- comment --><div id="hello" class="reu">foo <span class="blu"> bar</span></div> <home /> hello', Elenpi.rules.children, descriptor); 

//var res = Elenpi.exec('<!-- hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello -->', Elenpi.rules.comment, descriptor);
//var res = Elenpi.exec('<div>first</div><!-- hellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohellohello -->\n<div>hello</div>', Elenpi.rules.children, descriptor);

//    var res = calls.exec("    click ( '12', 14, true, blur(2, 4, hello( false).roo())). flup(12345)", descriptor);
//var res =  Elenpi.exec("flup(12345)", 'calls', descriptor);              
//Elenpi.exec("click(true, hello(14), bye, 12)", 'call');


console.timeEnd("lexer");


//Elenpi.exec("    click()", 'call');
console.log('|' + res + '|', JSON.stringify(descriptor.calls, null, ' '));
*/
//Elenpi.exec("click(true, hello(14), bye, 12)", 'call');



/*
    try {
        var r = exec("click()", Elenpi.rules.directives);
        // var r = exec("click(addUser).setClass('your-class', 'active')", Elenpi.rules.directives);
        console.log('lexer result : ', r);
    } catch (e) {
        console.log('error : ', e, e.stack);
    }
    */
/*
    var tag = l().regExp('<').id('tagName').space().zeroOrMore('attributes', attr().sp()).oneOf(chars('>').text().tagClose(), '/>');

    var attr = sp().id('attrName').zeroOrOne(l().regExp('=').oneOf(char('"').allBut('"').chars('"'), l().allBut(sp())));
    var text = allBut('<');

    var tagClose = regExp('</').id('tagName').sp().zeroOrMore('attributes', attr().space()).oneOf('>', '/>');
*/